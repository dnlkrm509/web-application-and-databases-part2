<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/png" href="Images/favicon.ico">
        <link rel="stylesheet" type="text/css" href="styles.css">
        <title>Simple Webpage</title>
    </head>
    <body>
        <div class="logoContainer">
            <div style="display: inline;float: right;z-index: 0;">
                <div style="position: absolute;background-color: white;height: 70px;width: 200px;z-index: 10;"></div>
                <div style="position: absolute;background-color: black;height: 70px;width: 70px;z-index: 20;"></div>
                <div class="marked"></div>
                <span style="position: absolute;color: white;font-size: 40px;z-index: 30;mix-blend-mode: difference;">Register</span>
            </div>
            <img src="./Images/gear.svg" class="logo" width="40" />
        </div>
        
        <button onclick="getMessage()">Get message</button>
        <button onclick="sendEcho()">Send message</button>
        <div id="response"></div>
        <script>
            const SERVER_HOST_URL = 'http://localhost:8080';

            async function getMessage() {
                try {
                    const response = await fetch('http://localhost:8080/M01008906/login?mode=dark&color=grey');
                    const data = await response.json();

                    if(response.status = 200) {
                        document.getElementById('response').innerHTML = "id=" + data.loggedinUser.id + "name=" + data.loggedinUser.name + "mode=" + data.loggedinUser.mode + "color=" + data.loggedinUser.color;
                    } else {
                        document.getElementById('response').innerHTML = data.error;
                    }
                } catch(err) {
                    document.getElementById('response').innerHTML = err;
                    throw Error('Response Status 400: Bad Request. Missing field', err);
                }
                
            }

            async function sendEcho() {
                const response = await fetch('http://localhost:8080/M01008906/login', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ user: {id:'1',name:'Daniel'} })
                });
                const data = await response.json();
                document.getElementById('response').innerHTML = data.message;
            }
        </script>
    </body>
</html>